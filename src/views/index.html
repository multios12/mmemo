<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="./favicon.ico">

  <title>HMemo</title>
  <script src="main.js" type="text/javascript"></script>
  <style type="text/css">
    .picture {
      display: inline-block;
      object-fit: contain;
      height: 120px;
      width: 120px;
    }

    .picture.over {
      border: 2px dashed #000;
    }

    .pictureSelectBox {
      border: 2px dashed #bbb;
      border-radius: 5px;
      padding: 0px;
      text-align: center;
      font-size: 64px;
      height: 120px;
      width: 120px;
      float: left;
    }

    .inputFile {
      height: 0px;
      visibility: hidden;
      position: absolute;
    }
  </style>


</head>

<body style="margin-top:60px">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false"
        aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">HMemo</a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav">
        <li class="nav-item active">
          <button type="button" class="btn btn-primary navbar-btn" id="registButton">Regist</a>
        </li>
      </ul>
    </div>
  </nav>

  <br>
  <!-- アラートメッセージ -->
  <div class="container">
    <div id="message" class="alert alert-info alert-dismissible" role="alert" style="display:none;">
      <button type="button" class="close" data-dismiss="alert" aria-label="閉じる">
        <span aria-hidden="true">×</span>
      </button>
      <strong>Oh snap!</strong> Change a few things up and try submitting again.
    </div>
  </div>

  <!-- リストコンテナ -->
  <div id="listContainer" class="container">
    <div id="listSection" class="table-responsive">
      <table id="list" class="table table-striped table-hover">
      </table>
    </div>
  </div>

  <!--編集コンテナ -->
  <div id="editContainer" style="display: none;" class="container">
    <div class="panel panel-primary">
      <div class="panel-heading">edit</div>
      <div class="panel-body">
        <form id="editForm" name="editForm" class="form-horizontal" data-toggle="validator" role="form">
          <input name="_id" type="hidden" value="" />
          <div class="form-group has-feedback">
            <label for="inputName" class="control-label col-sm-1">name:</label>
            <div class="col-sm-11">
              <input type="text" class="form-control input-lg" name="name" id="inputName" size="14" required/>
              <div class="help-block with-errors"></div>
            </div>
          </div>
          <div class="form-group">
            <label for="date" class="control-label col-sm-1">date:</label>
            <div class="col-sm-11">
              <div class="input-group date">
                <input id="date" name="date" type="text" class="form-control" required>
                <span class="input-group-addon">
                  <i class="glyphicon glyphicon-th"></i>
                </span>
              </div>
              <div class="help-block with-errors"></div>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">shop:</label>
            <div class="col-sm-11 form-inline">
              <input type="text" size="8" name="shoptype" class="form-control col-sm-3" style="width:40%" autocomplete="on" list="test"
              />
              <datalist id="test">
                <option value="ヘルス">
                  <option value="デリヘル">
                    <option value="ソープ">
              </datalist>
              <input type="text" name="shop" class="form-control col-sm-9" style="width:60%" />
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">home page:</label>
            <div class="col-sm-11">
              <input type="url" name="homepage" style="font-size:1vmax" class="form-control" />
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">play:</label>
            <div class="col-sm-11">
              <textarea name="play" class="form-control"></textarea>
            </div>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">talk:</label>
            <div class="col-sm-11">
              <textarea name="talk" class="form-control"></textarea>
            </div>
          </div>
          <div class="form-group">
            <div class="col-sm-11">
              <label class="control-label col-sm-1" style="padding:25px;">pictures:</label>
            </div>
            <div class="col-sm-11" style="overflow: hidden" id="imageGroup">
              <div id="imageBox" class="pictureSelectBox" draggable="false">
                <span class="glyphicon glyphicon-upload"></span>
                <input type="file" id="selectPicture" name="selectPicture" accept="image/jpeg, image/gif, image/png" class="inputFile" />
              </div>
            </div>
          </div>
          <script>
            var createObjectURL = (window.URL && window.URL.createObjectURL) ?
              (file) => window.URL.createObjectURL(file) :
              (window.webkitURL && window.webkitURL.createObjectURL) ?
                (file) => window.webkitURL.createObjectURL(file) : undefined;

            var picturePaths = [];
            document.getElementById('imageBox').addEventListener('click', () => document.getElementById('selectPicture').click());
            document.getElementById("selectPicture").addEventListener('change', function (e) {
              var file = e.target.files[0];
              if (!file) return;

              var reader = new FileReader();
              reader.onload = function (e) {
                var url = createObjectURL ? createObjectURL(file) : e.target.result;
                var img = document.createElement('img');
                img.id = createRandomString(12);
                img.src = url;
                img.draggable = true;
                img.classList.add("picture");
                img.addEventListener('dragstart', ev => {
                  ev.dataTransfer.setData('text', ev.target.id);
                });
                // ドラッグ中の要素がドロップ要素に重なった時
                img.addEventListener('dragover', function (ev) {
                  ev.preventDefault();
                  ev.dataTransfer.dropEffect = 'move';
                  dropArea.classList.add('dragover');
                });
                img.addEventListener('drop', function (ev) {
                  ev.preventDefault();
                  document.getElementById('imageGroup').insertBefore(document.getElementById(ev.dataTransfer.getData('text')), this);
                });
                document.getElementById('imageGroup').appendChild(img);
              };
              reader.readAsDataURL(this.files[0]);
            });

            function createRandomString(length) {
              var c = "abcdefghijklmnopqrstuvwxyz0123456789";
              var cl = c.length;
              var r = "";
              for (var i = 0; i < length; i++) {
                r += c[Math.floor(Math.random() * cl)];
              }
              return r;
            }
          </script>
          <div class="form-footer">
            <button id="editOkButton" type="submit" class="btn btn-lg btn-primary">
              <span class="glyphicon glyphicon-ok" style="font-size:32"></span> OK</button>
            <button id="editCloseButton" type="button" data-dismiss="modal" class="btn btn-lg btn-default">cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- ビューモーダル -->
  <div id="viewArea" class="modal fade" tabindex="-1">
    <div class="modal-dialog modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title" id="viewTitle">view</h4>
      </div>
      <!-- 5.モーダルのボディ -->
      <div class="modal-body">
        <form id="viewForm" name="viewForm" class="form-horizontal">
          <input name="_id" type="hidden" />
          <div class="form-group">
            <label class="control-label col-sm-1">name:</label>
            <p class="form-control-static col-sm-11" id="viewname" size="14"></p>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">date:</label>
            <p class="form-control-static col-sm-11" id="viewdate"></p>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">shop:</label>
            <p class="form-control-static col-sm-3" style="width:40%" id="viewshoptype"></p>
            <p class="form-control-static col-sm-8" style="width:60%" id="viewshop"></p>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">home page:</label>
            <p class="form-control-static col-sm-11" id="viewhomepage" style="font-size:1vmax" class="form-control"></p>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">play:</label>
            <p class="form-control-static col-sm-11" id="viewplay" class="form-control"></p>
          </div>
          <div class="form-group">
            <label class="control-label col-sm-1">talk:</label>
            <p class="form-control-static col-sm-11" id="viewtalk"></p>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" id="editButton" data-dismiss="modal" class="btn btn-lg btn-info">
          <span class="glyphicon glyphicon-edit"></span>
          edit</button>
        <input type="button" data-dismiss="modal" value="close" class="btn btn-lg btn-default" />
      </div>
    </div>
  </div>
</body>

</html>